# 数据仓库概念

数据仓库（ Data Warehouse ），用以**为企业制定决策，提供数据支持**。可以帮助企业**改进业务流程、提高产品质量**等。

## 输入数据

**业务数据**

+ 各行业在**处理事务**过程中产生的数据。比如用户在电商网站中登录、下单、支付等过程中，需要和网站后台数据库进行增删改查交互，产生的数据就是业务数据

+ **通常存储在MySQL、Oracle等数据库中**

**用户行为数据**

+ 用户在使用产品过程中，通过埋点收集与客户端产品交互过程中产生的数据，并发往日志服务器进行保存。比如页面浏览、点击、停留、评论、点赞、收藏等
+ **通常存储在日志文件中**

## 输出数据

+ **报表系统**
+ **用户画像**
+ **推荐系统**
+ **机器学习**

# 电商数仓项目简介

## 项目需求

+ 用户行为数据采集平台搭建
+ 业务数据采集平台搭建
+ 数据仓库维度建模
+ 分析设备、会员、商品、地区、活动等电商核心主题，统计的报表指标近100个
+ 采用即席查询工具，随时进行指标分析
+ 监控集群性能，发生异常时报警
+ 元数据管理
+ 质量监控
+ 权限管理

## 技术选型

+ 数据采集传输：**Flume、Kafka、Sqoop**、DataX
+ 数据存储：**MySQL、HDFS、HBase**、Redis、MongoDB
+ 数据计算：**Hive、Tez、Spark**、Flink、Storm
+ 数据查询：**Presto、Kylin**、Impala、Druid、ClickHouse、Doris
+ 数据可视化：**Echarts、Superset**、QuickBI、DataV
+ 任务调度：**Azkaban**、Oozie
+ 集群监控：**Zabbix**、Prometheus
+ 元数据管理：**Atlas**
+ 权限管理：**Ranger**、Sentry

### 具体版本型号

| 框架        | 旧版本   | 新版本    |
| ----------- | -------- | --------- |
| **Hadoop**  | 2.7.2    | **3.1.3** |
| Zookeeper   | 3.4.10   | 3.5.7     |
| MySQL       | 5.6.24   | 5.7.16    |
| Hive        | 1.2.1    | 3.1.2     |
| Flume       | 1.7.0    | 1.9.0     |
| **Kafka**   | 0.11-0.2 | **2.4.1** |
| Kafka Eagle | 1.3.7    | 1.4.5     |
| Azkaban     | 2.5.0    | 3.84.4    |
| **Spark**   | 2.1.1    | **3.0.0** |
| **HBase**   | 1.3.1    | **2.0.5** |
| Phoenix     | 4.14.1   | 5.0.0     |
| Sqoop       | 1.4.6    | 1.4.6     |
| Presto      | 0.189    | 0.189     |
| Kylin       | 2.5.1    | 3.0.1     |
| Atlas       | 0.8.4    | 2.0.0     |
| Ranger      | 2.0.0    | 2.0.0     |
| Solr        | 5.2.1    | 7.7.0     |

## 系统数据流程设计

详情见尚硅谷笔记

## 集群规模

假设：每台服务器8T硬盘，128G内存

1. 每天日活用户100万，每人一天平均100条：100万*100条 = 1亿条
2. 每条日志1k，每天1亿条：1亿/1024/1024 = 约100G
3. 半年内不扩容服务器：100G*180天 = 18T
4. 保存3副本：18T*3 = 54T
5. 预留20%-30%Buf：54T / 0.7 = 77T
6. 约等于 8T * 10台服务器

> 若考虑**数仓分层、数据压缩**，则需要重新计算

